<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Greg Nishihara">
  <title>データ解析（研究室用） - Redundancy Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Redundancy Analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Greg Nishihara 
</div>
</div>
</div>

  <p class="date">2024 / 04 / 29</p>
</section>
<section>
<section id="redundancy-analysis" class="title-slide slide level1 center">
<h1>Redundancy Analysis</h1>

</section>
<section id="what-is-rda" class="slide level2 smaller">
<h2>What is RDA</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Redundancy analysis (RDA)<sup>1</sup> a canonical ordination<sup>2</sup> method and is one type of <em>asymmetric canonical analysis</em><sup>3</sup> that is used to analyze two data tables simultaneously. In RDA we are interested in how the environmental data <span class="math inline">\((\mathbf{X})\)</span> influences ordination of the observation data <span class="math inline">\((\mathbf{Y})\)</span>. Recall that PCA is an unconstrained ordination<sup>4</sup>.</p>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center" data-hash="rda_cache/revealjs/unnamed-chunk-3_e6f3800ade0482f82b7addaeb6ed073d">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="rda_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" width="438"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>冗長性分析</p></li><li id="fn2"><p>制約付き序列化</p></li><li id="fn3"><p>非対称直接傾度分析</p></li><li id="fn4"><p>制約なし序列化</p></li></ol></aside></section>
<section id="asymmetric-canonical-analysis" class="slide level2 smaller">
<h2>Asymmetric canonical analysis</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>RDA (Redundancy analysis)</strong></p>
<ul>
<li>Each canonical axis corresponds to a direction that is most related to linear combinations<sup>1</sup> of variables in <span class="math inline">\(\mathbf{X}\)</span>.</li>
<li>Two ordinations
<ul>
<li>Linear combinations of <span class="math inline">\(\mathbf{Y}\)</span>.</li>
<li>Linear combinations of <span class="math inline">\(\mathbf{\hat{Y}}\)</span>.</li>
</ul></li>
<li>Preserves the Euclidean distance<sup>2</sup> among objects.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>CCA (Canonical correspondence analysis)</strong><sup>3</sup></p>
<ul>
<li>Simlar to RDA, except CCA preserves the <span class="math inline">\(\chi^2\)</span> distance between objects</li>
</ul>
<p><strong>LDA (Linear discriminant analysis)</strong><sup>4</sup></p>
<ul>
<li><span class="math inline">\(\mathbf{Y}\)</span> is divided in to <span class="math inline">\(k\)</span> groups described by a factor.</li>
<li>Searches for the linear combinations in <span class="math inline">\(\mathbf{X}\)</span> that can explain the groups by maximizing the dispersion of the centroids of groups.</li>
</ul>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn5"><p>線型結合</p></li><li id="fn6"><p>ユークリッド距離</p></li><li id="fn7"><p>正準対応分析</p></li><li id="fn8"><p>線形判別分析</p></li></ol></aside></section>
<section id="approaches-to-analyze-community-data" class="slide level2">
<h2>Approaches to analyze community data</h2>
<ol type="1">
<li>Use DCA to choose RDA or CCA.</li>
</ol>
<ul>
<li>If the length of the first DCA axis &gt; 4 use CCA.</li>
<li>If the length of the first DCA axis &gt; 3 use RDA.</li>
<li>If the length is between 3 and 4, use either CCA or RDA.</li>
</ul>
<ol start="2" type="1">
<li>If you transform the <span class="math inline">\(\mathbf{Y}\)</span>,</li>
</ol>
<ul>
<li>Do not apply DCA.</li>
<li>Choose RDA for the analysis.</li>
</ul>
<ol start="3" type="1">
<li>Use distance-based RDA.</li>
</ol>
</section>
<section id="rda-preparation" class="slide level2">
<h2>RDA preparation</h2>
<ul>
<li>Each variable in <span class="math inline">\(\mathbf{Y}\)</span> and <span class="math inline">\(\mathbf{X}\)</span> should be centered (i.e., have means of zero).</li>
<li>Each variable in <span class="math inline">\(\mathbf{Y}\)</span> and <span class="math inline">\(\mathbf{X}\)</span> should be standardized (i.e., divide by the standard deviation).</li>
<li>Check for multi-collinearity among <span class="math inline">\(\mathbf{X}\)</span>.</li>
</ul>

<aside><div>
<p>In otherwords, determine the z-score <span class="math inline">\((z = (x - \overline{x}) \big/ s)\)</span>.</p>
</div></aside></section>
<section id="rda-algorithm" class="slide level2">
<h2>RDA Algorithm</h2>
<ol type="1">
<li>Multiple regression <span class="math inline">\(\mathbf{Y} \sim \mathbf{X}\)</span></li>
<li>PCA on the expected value of <span class="math inline">\(\mathbf{Y}\)</span> determined from the multiple regression (i.e., <span class="math inline">\(\mathbf{\hat{Y}}\)</span>)</li>
<li>PCA on the residuals of the multiple regression <span class="math inline">\(\mathbf{Y_{res}} = \mathbf{Y} - \mathbf{\hat{Y}}\)</span></li>
</ol>
</section></section>
<section>
<section id="numerical-examples" class="title-slide slide level1 center">
<h1>Numerical examples</h1>

</section>
<section id="observation-data-mathbfy" class="slide level2">
<h2>Observation data <span class="math inline">\((\mathbf{Y})\)</span></h2>
<p>The presence-absence community matrix<sup>1</sup> is a series of zeros and ones to indicate absence and presence, respectively.</p>
<p>The dimensions of the matrix (rows and columns).</p>
<div class="cell columns column-output-location" data-hash="rda_cache/revealjs/unnamed-chunk-6_d218cad4c70fa6bf622121558055f500">
<div class="column">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>seaweed <span class="sc">|&gt;</span> <span class="fu">dim</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 147 108</code></pre>
</div>
</div>
</div>
<p>Example of some data points.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-7_b3158bb84bddd74119137f1eeb5002a7">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>seaweed[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="font-size: 0.4em"><code># A tibble: 3 × 3
  `Colpomenia-spp` `Dictyota-spiralis` `Gelidium-spp`
             &lt;dbl&gt;               &lt;dbl&gt;          &lt;dbl&gt;
1                0                   1              1
2                0                   0              1
3                0                   0              1</code></pre>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn9"><p>在不在群集行列</p></li></ol></aside></section>
<section id="hellinger-transform" class="slide level2 smaller">
<h2>Hellinger transform</h2>
<p>If we are interested in changes of relative species occurrence, then one good transformation is the Hellinger transform. The Hellinger transform is the square root of each element in a row divided by its row-sum.</p>
<p><span class="math display">\[
y\prime_{ij} = \sqrt{\frac{y_{ij}}{\sum y_{i}}}
\]</span></p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-8_4f77fff647398c4665c7db4ab5b79afb">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>Y <span class="ot">=</span> <span class="fu">decostand</span>(seaweed, <span class="st">"hellinger"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-9_6360a73dfb1acc38dfe7987aae373479">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>Y[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Colpomenia-spp Dictyota-spiralis Gelidium-spp
3              0         0.2294157    0.2294157
4              0         0.0000000    0.2182179
5              0         0.0000000    0.2182179</code></pre>
</div>
</div>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-10_a6c543cda455f46e853fefddbf767805">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="fu">sqrt</span>(seaweed[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">/</span> <span class="fu">rowSums</span>(seaweed)[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Colpomenia-spp Dictyota-spiralis Gelidium-spp
1              0         0.2294157    0.2294157
2              0         0.0000000    0.2182179
3              0         0.0000000    0.2182179</code></pre>
</div>
</div>
</section>
<section id="standardize-environmental-data" class="slide level2 smaller">
<h2>Standardize environmental data</h2>
<p>The environmental variables should be standardized (i.e, find the z-score).</p>
<p><span class="math display">\[
z = \frac{x - \bar{x}}{s}
\]</span> where <span class="math inline">\(x\)</span> is the value, <span class="math inline">\(\bar{x}\)</span> is the mean value of <span class="math inline">\(x\)</span>, and <span class="math inline">\(s\)</span> is the standard deviation of <span class="math inline">\(x\)</span>. This data is already standardized.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-11_19cf792833a63a0936ec6d5fe2494a26">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>envdata <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 147 × 10
  year  season station month depth_mean pla_10…¹ sed_d…² herbi…³ compe…⁴ temp_…⁵
  &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 2021  WS     St01    4         -0.904   -1.34   -0.904   1.84   -0.372    1.92
2 2021  WS     St02    4         -0.254   -1.03   -0.783   0.122  -0.673    1.20
3 2021  WS     St03    4          1.88    -0.151  -0.213   0.837   1.50    -1.32
# … with 144 more rows, and abbreviated variable names ¹​pla_100g_day_mean,
#   ²​sed_day_mean, ³​herbivorous_A_mean, ⁴​competing_A_mean, ⁵​temp_range_mean</code></pre>
</div>
</div>

<aside><div>

</div></aside></section>
<section id="check-length-of-first-axis" class="slide level2 smaller">
<h2>Check length of first axis</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>If the length of the first axis is &gt; 4.5, then use CCA not RDA (Leps &amp; Smilauer 2003).</p>
</div><div class="column" style="width:50%;">
<ul>
<li>&gt; 4 CCA: <code>cca()</code></li>
<li>3 ~ 4: <code>rda()</code> or <code>cca()</code></li>
<li>&lt; 3 RDA: <code>rda()</code></li>
</ul>
</div>
</div>
<div class="cell columns column-output-location" data-hash="rda_cache/revealjs/unnamed-chunk-13_fc651227d3ee087c3bae59ed79541b9f">
<div class="column">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="fu">decorana</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre style="font-size: 0.4em"><code>
Call:
decorana(veg = Y) 

Detrended correspondence analysis with 26 segments.
Rescaling of axes with 4 iterations.
Total inertia (scaled Chi-square): 4.9589 

                       DCA1   DCA2   DCA3   DCA4
Eigenvalues          0.3195 0.2796 0.1848 0.1298
Additive Eigenvalues 0.3195 0.2797 0.1825 0.1250
Decorana values      0.3435 0.2744 0.1757 0.1325
Axis lengths         3.5600 2.9877 2.8427 2.1297</code></pre>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>If the Hellinger transform is applied, then it is simpler to use <code>rda()</code> and not worry about the <code>dca()</code>.</p>
</div>
</div>
</div>
</section>
<section id="null-model" class="slide level2">
<h2>Null Model</h2>
<p>Define the null model and the full model of the multiple linear regression component.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-14_09d0c1db50e26c3c7c8031e4fc46790a">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>nullmodel <span class="ot">=</span> Y <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb14-2"><a></a>fullmodel <span class="ot">=</span> Y <span class="sc">~</span> pla_100g_day_mean <span class="sc">+</span> </span>
<span id="cb14-3"><a></a>  temp_range_mean <span class="sc">+</span></span>
<span id="cb14-4"><a></a>  season <span class="sc">+</span> </span>
<span id="cb14-5"><a></a>  competing_A_mean <span class="sc">+</span></span>
<span id="cb14-6"><a></a>  herbivorous_A_mean <span class="sc">+</span></span>
<span id="cb14-7"><a></a>  sed_day_mean <span class="sc">+</span></span>
<span id="cb14-8"><a></a>  depth_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="forward-selection" class="slide level2 smaller">
<h2>Forward selection</h2>
<p>Use forward selection to eliminate unnecessary environmental variables. Removing variables will affect the scores and loadings.</p>
<p>Fit the null model.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-15_26ff36e11d69435b6353b60f70d65f6d">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>rdamodel0 <span class="ot">=</span> <span class="fu">rda</span>(<span class="fu">formula</span>(nullmodel), <span class="at">data =</span> envdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit the full model.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-16_3f8188cc5c582932257d4b342b9b95a6">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>rdamodelf <span class="ot">=</span> <span class="fu">rda</span>(<span class="fu">formula</span>(fullmodel), <span class="at">data =</span> envdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run the forward selection.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-17_affce0b54b5d0a0b585e29aa6fca311e">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>rdamodel <span class="ot">=</span> <span class="fu">ordiR2step</span>(rdamodel0, <span class="co"># null</span></span>
<span id="cb17-2"><a></a>                     <span class="at">scope =</span> <span class="fu">formula</span>(fullmodel), <span class="co"># full</span></span>
<span id="cb17-3"><a></a>                     <span class="at">R2permutations =</span> <span class="dv">2</span><span class="sc">^</span><span class="dv">15</span>,</span>
<span id="cb17-4"><a></a>                     <span class="at">trace =</span> <span class="cn">FALSE</span>) <span class="co"># change to TRUE to see the selection process!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>

<img data-src="rda_files/figure-revealjs/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center r-stretch" width="464"><div class="r-stack">
<div class="fragment fade-out">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>(A) RDA model selected by <code>ordiR2step()</code>.</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>(B) The variance and proportions explained by the constrained and unconstrained parts of the model.</li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>(C) The eigenvalues of the constrained components. These are the eigenvalues of the PCA run on the residuals.</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>(D) The eigenvalues of the unconstrained components. These are the eigenvalues of the PCA run on the expected values.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="variance-inflation-factor" class="slide level2">
<h2>Variance inflation factor</h2>
<p>Use the variance inflation factor (VIF)<sup>1</sup> to check for multi-collinearity<sup>2</sup>. If it is larger than 10, then variable is can be removed from the model.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-20_36cef38c6dc48ac5805e76361d3e38de">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="fu">vif.cca</span>(rdamodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> pla_100g_day_mean           seasonWS       sed_day_mean herbivorous_A_mean 
          2.064950           1.024439           2.455251           3.070272 
  competing_A_mean         depth_mean 
          3.936895           3.396944 </code></pre>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn10"><p>分散拡大係数</p></li><li id="fn11"><p>多重共線性</p></li></ol></aside></section>
<section id="redundancy-analysis-model" class="slide level2">
<h2>Redundancy analysis model</h2>
<p>Solve for the eigenvalues <span class="math inline">\((\mathbf{\lambda_k})\)</span> and eigenvectors <span class="math inline">\((\mathbf{u_k})\)</span> of the redundancy analysis model.</p>
<p><span class="math display">\[
\left(\mathbf{S_{YX}}\mathbf{S_{XX}^{-1}}\mathbf{S_{YX}^\prime} - \mathbf{\lambda_k}\mathbf{I}\right)\mathbf{u_k}=0
\]</span></p>
<p>where, <span class="math inline">\(\mathbf{S_{YX}}\)</span> is the covariance matrix of <span class="math inline">\(\mathbf{Y}\)</span> and <span class="math inline">\(\mathbf{Y}\)</span>, <span class="math inline">\(\mathbf{S_{XX}^{-1}}\)</span> is the covariance matrix of $, and <span class="math inline">\(\mathbf{I}\)</span> is the identity matrix.</p>
</section>
<section id="find-the-solution" class="slide level2">
<h2>Find the solution</h2>
<p>First standardize the Y and X matrices.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-21_58860eac3fa0da4d0a2a26c5fc8b5fda">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>Y <span class="ot">=</span> iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb20-2"><a></a>X <span class="ot">=</span> iris[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb20-3"><a></a>X <span class="ot">=</span> <span class="fu">apply</span>(X, <span class="dv">2</span>, scale)</span>
<span id="cb20-4"><a></a>Y <span class="ot">=</span> <span class="fu">apply</span>(Y, <span class="dv">2</span>, scale)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, fit the <code>rda()</code> version for comparison.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-22_b6825c77d2b38bbc6fd7ba8bad570030">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>rdaout <span class="ot">=</span> <span class="fu">rda</span>(Y<span class="sc">~</span>X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then find <span class="math inline">\(\mathbf{\hat{Y}}\)</span> multivariate linear regression <span class="math inline">\(\mathbf{Y} \sim \mathbf{X}\)</span>.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-23_7fb07c2aeb262a88fbca7d057a0e3b46">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>sxxinv <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X)</span>
<span id="cb22-2"><a></a>syx <span class="ot">=</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> X</span>
<span id="cb22-3"><a></a>syxtr <span class="ot">=</span> <span class="fu">t</span>(syx)</span>
<span id="cb22-4"><a></a>Yhat <span class="ot">=</span> X <span class="sc">%*%</span> sxxinv <span class="sc">%*%</span> syxtr</span>
<span id="cb22-5"><a></a>Yres <span class="ot">=</span> Y <span class="sc">-</span> Yhat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="confirm-the-eigenvalues" class="slide level2">
<h2>Confirm the eigenvalues</h2>
<p>Calculate the eigenvalues for the PCA part.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-24_ce6e61daedeac530e82eb7fc850bed17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="co"># PCA part</span></span>
<span id="cb23-2"><a></a><span class="fu">svd</span>(Yres)<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="fu">nrow</span>(Y) <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8965380 0.1240973</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>rdaout<span class="sc">$</span>CA<span class="sc">$</span>eig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PC1       PC2 
0.8965380 0.1240973 </code></pre>
</div>
</div>
<p>Calculate the eigenvalues for the RDA part.</p>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-25_833b819fd17bb42f7aed72d8cf43d804">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a><span class="co"># RDA part</span></span>
<span id="cb27-2"><a></a><span class="fu">svd</span>(Yhat)<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="fu">nrow</span>(Y) <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.96547259 0.01389207</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>rdaout<span class="sc">$</span>CCA<span class="sc">$</span>eig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      RDA1       RDA2 
0.96547259 0.01389207 </code></pre>
</div>
</div>
</section>
<section id="confirm-the-eigenvectors" class="slide level2">
<h2>Confirm the eigenvectors</h2>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-26_5952026517ac7f9a7f36f147fd829265">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a><span class="fu">svd</span>(Yres)<span class="sc">$</span>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]       [,2]
[1,] 0.3767512  0.9263145
[2,] 0.9263145 -0.3767512</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>rdaout<span class="sc">$</span>CA<span class="sc">$</span>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   PC1        PC2
Sepal.Length 0.3767512  0.9263145
Sepal.Width  0.9263145 -0.3767512</code></pre>
</div>
</div>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-27_7bdcf67a34c27cdaa5b69a71cf0e0dd9">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="fu">svd</span>(Yhat)<span class="sc">$</span>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]      [,2]
[1,]  0.8891863 0.4575454
[2,] -0.4575454 0.8891863</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>rdaout<span class="sc">$</span>CCA<span class="sc">$</span>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   RDA1      RDA2
Sepal.Length  0.8891863 0.4575454
Sepal.Width  -0.4575454 0.8891863</code></pre>
</div>
</div>
</section>
<section id="calcualte-inertias" class="slide level2">
<h2>Calcualte inertias</h2>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-28_f5aba543268eef9e219aff9d380e851c">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a>n <span class="ot">=</span> <span class="fu">nrow</span>(Y)</span>
<span id="cb39-2"><a></a>constrained <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">svd</span>(Yhat)<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb39-3"><a></a>unconstrained <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">svd</span>(Yres)<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb39-4"><a></a>total <span class="ot">=</span> constrained <span class="sc">+</span> unconstrained</span>
<span id="cb39-5"><a></a></span>
<span id="cb39-6"><a></a><span class="fu">tibble</span>(<span class="at">type =</span> <span class="fu">c</span>(<span class="st">"Total"</span>, <span class="st">"Constrained"</span>, <span class="st">"Unconstrained"</span>),</span>
<span id="cb39-7"><a></a>       <span class="at">Inertia =</span> <span class="fu">c</span>(total, constrained, unconstrained)) <span class="sc">|&gt;</span> </span>
<span id="cb39-8"><a></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> Inertia <span class="sc">/</span> total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  type          Inertia Proportion
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;
1 Total           2.00       1    
2 Constrained     0.979      0.490
3 Unconstrained   1.02       0.510</code></pre>
</div>
</div>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-29_df23c15fdb268a4df82a536764302e00">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a>rdaout</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: rda(formula = Y ~ X)

              Inertia Proportion Rank
Total          2.0000     1.0000     
Constrained    0.9794     0.4897    2
Unconstrained  1.0206     0.5103    2
Inertia is variance 

Eigenvalues for constrained axes:
  RDA1   RDA2 
0.9655 0.0139 

Eigenvalues for unconstrained axes:
   PC1    PC2 
0.8965 0.1241 </code></pre>
</div>
</div>
</section>
<section id="confirm-the-site-scores" class="slide level2">
<h2>Confirm the site scores</h2>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-30_9b2b55218f31af94f5994c4d41b2da7a">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a>rdascores <span class="ot">=</span> <span class="fu">scores</span>(rdaout, <span class="at">scaling =</span> <span class="dv">0</span>, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb43-2"><a></a>eigscores <span class="ot">=</span> Y <span class="sc">%*%</span> <span class="fu">svd</span>(Yhat)<span class="sc">$</span>v <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">svd</span>(Yhat)<span class="sc">$</span>d)  <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb43-3"><a></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb43-4"><a></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">color =</span> <span class="st">"EIG"</span>), <span class="at">data =</span> eigscores, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> RDA1, <span class="at">y =</span> RDA2, <span class="at">color =</span> <span class="st">"RDA"</span>), <span class="at">data =</span> rdascores, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="rda_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section id="confirm-the-environmental-variables" class="slide level2">
<h2>Confirm the environmental variables</h2>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-31_66e12119c8fc4af105591da458604027">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a>variables <span class="ot">=</span> <span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(Y), <span class="st">"[a-z|</span><span class="sc">\\</span><span class="st">.]"</span>)</span>
<span id="cb44-2"><a></a>rdavariables <span class="ot">=</span> <span class="fu">scores</span>(rdaout, <span class="at">scaling =</span> <span class="dv">0</span>, <span class="at">display =</span> <span class="st">"bp"</span>) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb44-3"><a></a>temp <span class="ot">=</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> <span class="fu">svd</span>(Yhat)<span class="sc">$</span>u</span>
<span id="cb44-4"><a></a>svdvariables <span class="ot">=</span> <span class="fu">apply</span>(temp, <span class="dv">1</span>, \(x) x <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">|&gt;</span> <span class="fu">t</span>() <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb44-5"><a></a>rdavariables <span class="ot">=</span> rdavariables <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">variables =</span> variables, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb44-6"><a></a>svdvariables <span class="ot">=</span> svdvariables <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">variables =</span> variables, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb44-7"><a></a><span class="fu">full_join</span>(rdavariables, svdvariables, <span class="at">by =</span> <span class="st">"variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  variables  RDA1  RDA2    V1    V2
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 SL        0.988 0.152 0.988 0.152
2 SW        0.911 0.413 0.911 0.413</code></pre>
</div>
</div>
</section>
<section id="example-analysis" class="slide level2">
<h2>Example analysis</h2>
<p>Example data set.</p>
<p>Dune meadow vegetation data.</p>
<ul>
<li>A1 soil thickness</li>
<li>Moisture ordered factor of levels 1 &lt; 2 &lt; 4 &lt; 5</li>
<li>Management factor of 4 levels</li>
<li>Use ordered factor Hayfield &lt; Haypastu &lt; Pasture</li>
<li>Manure Ordered factor 0 &lt; 1 &lt; 2 &lt; 3 &lt; 4</li>
</ul>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-32_31eae54414992dd50adddad4cce16697">
<div class="cell-output cell-output-stdout">
<pre><code>   Achimill Agrostol Airaprae Alopgeni Anthodor Bellpere Bromhord Chenalbu
1         1        0        0        0        0        0        0        0
2         1        0        0        1        0        1        1        0
3         0        1        0        1        0        1        0        0
4         0        1        0        1        0        1        1        0
5         1        0        0        0        1        1        1        0
6         1        0        0        0        1        0        0        0
7         1        0        0        0        1        0        1        0
8         0        1        0        1        0        0        0        0
9         0        1        0        1        0        0        0        0
10        1        0        0        0        1        1        1        0
11        0        0        0        0        0        0        0        0
12        0        1        0        1        0        0        0        0
13        0        1        0        1        0        0        0        1
14        0        1        0        0        0        0        0        0
15        0        1        0        0        0        0        0        0
16        0        1        0        1        0        0        0        0
17        1        0        1        0        1        0        0        0
18        0        0        0        0        0        1        0        0
19        0        0        1        0        1        0        0        0
20        0        1        0        0        0        0        0        0
   Cirsarve Comapalu Eleopalu Elymrepe Empenigr Hyporadi Juncarti Juncbufo
1         0        0        0        1        0        0        0        0
2         0        0        0        1        0        0        0        0
3         0        0        0        1        0        0        0        0
4         1        0        0        1        0        0        0        0
5         0        0        0        1        0        0        0        0
6         0        0        0        0        0        0        0        0
7         0        0        0        0        0        0        0        1
8         0        0        1        0        0        0        1        0
9         0        0        0        1        0        0        1        1
10        0        0        0        0        0        0        0        0
11        0        0        0        0        0        1        0        0
12        0        0        0        0        0        0        0        1
13        0        0        0        0        0        0        0        1
14        0        1        1        0        0        0        0        0
15        0        1        1        0        0        0        1        0
16        0        0        1        0        0        0        1        0
17        0        0        0        0        0        1        0        0
18        0        0        0        0        0        0        0        0
19        0        0        0        0        1        1        0        0
20        0        0        1        0        0        0        1        0
   Lolipere Planlanc Poaprat Poatriv Ranuflam Rumeacet Sagiproc Salirepe
1         1        0       1       1        0        0        0        0
2         1        0       1       1        0        0        0        0
3         1        0       1       1        0        0        0        0
4         1        0       1       1        0        0        1        0
5         1        1       1       1        0        1        0        0
6         1        1       1       1        0        1        0        0
7         1        1       1       1        0        1        0        0
8         1        0       1       1        1        0        1        0
9         1        0       1       1        0        1        1        0
10        1        1       1       1        0        0        0        0
11        1        1       1       0        0        0        1        0
12        0        0       0       1        0        1        1        0
13        0        0       1       1        1        0        1        0
14        0        0       0       0        1        0        0        0
15        0        0       0       0        1        0        0        0
16        0        0       0       1        1        0        0        0
17        0        1       1       0        0        0        0        0
18        1        1       1       0        0        0        0        1
19        0        0       0       0        0        0        1        1
20        0        0       0       0        1        0        0        1
   Scorautu Trifprat Trifrepe Vicilath Bracruta Callcusp
1         0        0        0        0        0        0
2         1        0        1        0        0        0
3         1        0        1        0        1        0
4         1        0        1        0        1        0
5         1        1        1        0        1        0
6         1        1        1        0        1        0
7         1        1        1        0        1        0
8         1        0        1        0        1        0
9         1        0        1        0        1        0
10        1        0        1        1        1        0
11        1        0        1        1        1        0
12        1        0        1        0        1        0
13        1        0        1        0        0        0
14        1        0        1        0        0        1
15        1        0        1        0        1        0
16        0        0        0        0        1        1
17        1        0        0        0        0        0
18        1        0        1        1        1        0
19        1        0        1        0        1        0
20        1        0        0        0        1        1</code></pre>
</div>
</div>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-33_99fae65b61188ae2be8127b7fbddebb3">
<div class="cell-output cell-output-stdout">
<pre><code>     A1 Moisture Management      Use Manure
1   2.8        1         SF Haypastu      4
2   3.5        1         BF Haypastu      2
3   4.3        2         SF Haypastu      4
4   4.2        2         SF Haypastu      4
5   6.3        1         HF Hayfield      2
6   4.3        1         HF Haypastu      2
7   2.8        1         HF  Pasture      3
8   4.2        5         HF  Pasture      3
9   3.7        4         HF Hayfield      1
10  3.3        2         BF Hayfield      1
11  3.5        1         BF  Pasture      1
12  5.8        4         SF Haypastu      2
13  6.0        5         SF Haypastu      3
14  9.3        5         NM  Pasture      0
15 11.5        5         NM Haypastu      0
16  5.7        5         SF  Pasture      3
17  4.0        2         NM Hayfield      0
18  4.6        1         NM Hayfield      0
19  3.7        5         NM Hayfield      0
20  3.5        5         NM Hayfield      0</code></pre>
</div>
</div>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-34_7e1f6e44d19213f68273b82cc30159db">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
      A1 Moisture Management Use      Manure
   &lt;dbl&gt; &lt;ord&gt;    &lt;fct&gt;      &lt;ord&gt;    &lt;ord&gt; 
 1   2.8 1        SF         Haypastu 4     
 2   3.5 1        BF         Haypastu 2     
 3   4.3 2        SF         Haypastu 4     
 4   4.2 2        SF         Haypastu 4     
 5   6.3 1        HF         Hayfield 2     
 6   4.3 1        HF         Haypastu 2     
 7   2.8 1        HF         Pasture  3     
 8   4.2 5        HF         Pasture  3     
 9   3.7 4        HF         Hayfield 1     
10   3.3 2        BF         Hayfield 1     
11   3.5 1        BF         Pasture  1     
12   5.8 4        SF         Haypastu 2     
13   6   5        SF         Haypastu 3     
14   9.3 5        NM         Pasture  0     
15  11.5 5        NM         Haypastu 0     
16   5.7 5        SF         Pasture  3     
17   4   2        NM         Hayfield 0     
18   4.6 1        NM         Hayfield 0     
19   3.7 5        NM         Hayfield 0     
20   3.5 5        NM         Hayfield 0     </code></pre>
</div>
</div>
<div class="cell" data-hash="rda_cache/revealjs/unnamed-chunk-36_9c2a32335a6946ccc948be56095b44e9">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(formula = dune ~ A1 + Moisture + Use + Manure, data = dune.env) 

Partitioning of variance:
              Inertia Proportion
Total           5.261     1.0000
Constrained     3.384     0.6432
Unconstrained   1.877     0.3568

Eigenvalues, and their contribution to the variance 

Importance of components:
                        RDA1   RDA2    RDA3    RDA4    RDA5    RDA6    RDA7
Eigenvalue            1.4129 0.7859 0.28559 0.24176 0.17851 0.15076 0.12636
Proportion Explained  0.2686 0.1494 0.05429 0.04596 0.03393 0.02866 0.02402
Cumulative Proportion 0.2686 0.4180 0.47226 0.51822 0.55215 0.58081 0.60483
                        RDA8    RDA9    RDA10     PC1     PC2     PC3     PC4
Eigenvalue            0.1021 0.06278 0.037263 0.43922 0.43799 0.29683 0.22855
Proportion Explained  0.0194 0.01193 0.007083 0.08349 0.08326 0.05643 0.04345
Cumulative Proportion 0.6242 0.63616 0.643248 0.72674 0.81000 0.86643 0.90988
                          PC5     PC6     PC7     PC8      PC9
Eigenvalue            0.16015 0.12726 0.09615 0.06368 0.026875
Proportion Explained  0.03044 0.02419 0.01828 0.01210 0.005109
Cumulative Proportion 0.94032 0.96451 0.98279 0.99489 1.000000

Accumulated constrained eigenvalues
Importance of components:
                        RDA1   RDA2   RDA3    RDA4    RDA5    RDA6    RDA7
Eigenvalue            1.4129 0.7859 0.2856 0.24176 0.17851 0.15076 0.12636
Proportion Explained  0.4175 0.2322 0.0844 0.07144 0.05275 0.04455 0.03734
Cumulative Proportion 0.4175 0.6498 0.7342 0.80563 0.85838 0.90293 0.94027
                         RDA8    RDA9   RDA10
Eigenvalue            0.10206 0.06278 0.03726
Proportion Explained  0.03016 0.01855 0.01101
Cumulative Proportion 0.97043 0.98899 1.00000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for rda under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

Model: rda(formula = dune ~ A1 + Moisture + Use + Manure, data = dune.env)
         Df Variance      F Pr(&gt;F)   
A1        1  0.54865 2.6311  0.006 **
Moisture  3  1.44897 2.3162  0.002 **
Use       2  0.50253 1.2050  0.257   
Manure    4  0.88368 1.0595  0.406   
Residual  9  1.87670                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for rda under reduced model
Forward tests for axes
Permutation: free
Number of permutations: 999

Model: rda(formula = dune ~ A1 + Moisture + Use + Manure, data = dune.env)
         Df Variance      F Pr(&gt;F)   
RDA1      1  1.41288 6.7757  0.002 **
RDA2      1  0.78586 3.7687  0.117   
RDA3      1  0.28559 1.3696  0.996   
RDA4      1  0.24176 1.1594  1.000   
RDA5      1  0.17851 0.8561  0.999   
RDA6      1  0.15076 0.7230  1.000   
RDA7      1  0.12636 0.6060  1.000   
RDA8      1  0.10206 0.4894  1.000   
RDA9      1  0.06278 0.3011  1.000   
RDA10     1  0.03726 0.1787  0.999   
Residual  9  1.87670                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>


<img data-src="rda_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"><div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>