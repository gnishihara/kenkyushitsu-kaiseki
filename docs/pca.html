<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Greg Nishihara">
  <title>データ解析（研究室用） - Principal Component Analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Principal Component Analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Greg Nishihara 
</div>
</div>
</div>

  <p class="date">2024 / 05 / 15</p>
</section>
<section>
<section id="redundancy-analysis" class="title-slide slide level1 center">
<h1>Redundancy Analysis</h1>
<p>Principal component analysis (PCA) is a method to find new variables (i.e., principal components) that are linear functions of the original variables. The new variable should successively maximizes variance and should not be correlated with each other. The principal components are found by eigenanalysis <span class="citation" data-cites="jolliffe2016 hotelling1933 pearson1901">(<a href="#/references" role="doc-biblioref" onclick="">Jolliffe and Cadima 2016</a>; <a href="#/references" role="doc-biblioref" onclick="">Hotelling 1933</a>; <a href="#/references" role="doc-biblioref" onclick="">Pearson 1901</a>)</span>.</p>
</section>
<section id="principal-component-analysis-pca" class="slide level2">
<h2>Principal component analysis (PCA)</h2>
<p>PCA<sup>1</sup> is the eigenanalysis<sup>2</sup> of the <span class="math inline">\(p\times p\)</span> variance – covariance matrix<sup>3</sup> <span class="math inline">\(\Sigma\)</span></p>
<p><span class="math display">\[
\mathbf{\Sigma} = \frac{\mathbf{Y_c}^\top \mathbf{Y_c}}{n-1}
\]</span></p>

<aside><div>
<p><span class="math inline">\(\mathbf{Y}_c\)</span> is the column-centered matrix of the orignal data <span class="math inline">\(\mathbf{Y}\)</span>. <span class="math inline">\(n\)</span> is the number of rows in <span class="math inline">\(\mathbf{Y}_c\)</span>.</p>
</div><ol class="aside-footnotes"><li id="fn1"><p>主成分分析</p></li><li id="fn2"><p>固有値解析</p></li><li id="fn3"><p>分散共分散行列</p></li></ol></aside></section>
<section id="definition-of-mathbfy_c" class="slide level2">
<h2>Definition of <span class="math inline">\(\mathbf{Y_c}\)</span></h2>
<div style="font-size:50%;">
<p><span class="math display">\[
\overbrace{\begin{bmatrix}2.25 &amp; 2.00 &amp; 2.00\\-1.75 &amp;  0.00 &amp; -2.00\\ 0.25 &amp; -1.00 &amp; -2.00\\-0.75 &amp; -1.00 &amp;  2.00\end{bmatrix}}^{\mathbf{Y_c}} =
\overbrace{\begin{bmatrix}5 &amp; 4 &amp; 5\\1 &amp; 2 &amp; 1\\3 &amp; 1 &amp; 1\\2 &amp; 1 &amp; 5\end{bmatrix}}^{\mathbf{Y}} -
\overbrace{\begin{bmatrix}2.75 &amp; 2.00 &amp; 3.00\\2.75 &amp; 2.00 &amp; 3.00\\2.75 &amp; 2.00 &amp; 3.00\\2.75 &amp; 2.00 &amp; 3.00\end{bmatrix}}^{\overline{\mathbf{Y}}}
\]</span></p>
</div>
<p><span class="math inline">\(\mathbf{Y}\)</span> is the original data, <span class="math inline">\(\overline{\mathbf{Y}}\)</span> is the column-means of <span class="math inline">\(\mathbf{Y}\)</span>.</p>
</section>
<section id="decomposition-of-mathbfy_c" class="slide level2">
<h2>Decomposition of <span class="math inline">\(\mathbf{Y_c}\)</span></h2>
<p>The eigenanalysis of <span class="math inline">\(\Sigma\)</span> is defined as the following:</p>
<p><span class="math display">\[
\frac{\mathbf{Y_c}^\top \mathbf{Y_c}}{n-1}  = \mathbf{\Sigma} = \mathbf{V}_{pca}\mathbf{L}\mathbf{V}_{pca}^\top
\]</span></p>
<p>where, <span class="math inline">\(\mathbf{V}_{pca} = \begin{bmatrix}\mathbf{v_1} &amp; \mathbf{v_2} &amp; \cdots &amp; \mathbf{v_p}\end{bmatrix}\)</span> is a matrix of <span class="math inline">\(p\)</span> eigenvectors<sup>1</sup> and <span class="math inline">\(\mathbf{L}\)</span> is a diagonal matrix of the eigenvalues<sup>2</sup>. Each <span class="math inline">\(\mathbf{v_i}\)</span> is also known as the <span class="math inline">\(i\)</span>th principal component<sup>3</sup>.</p>
<aside><ol class="aside-footnotes"><li id="fn4"><p>固有ベクトル</p></li><li id="fn5"><p>固有値</p></li><li id="fn6"><p>主成分</p></li></ol></aside></section>
<section id="eigenvalue" class="slide level2">
<h2>Eigenvalue</h2>
<p>The eigenvalue matrix is a <span class="math inline">\(p\times p\)</span> diagonal matrix<sup>1</sup>.</p>
<p><span class="math display">\[
\mathbf{L} =
\begin{bmatrix}
\lambda_1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \lambda_2  &amp; 0 &amp; \cdots &amp; 0 \\
\vdots  &amp;   &amp; \ddots  &amp; \   &amp; \vdots  \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; \lambda_p \\
\end{bmatrix}
\]</span></p>

<aside><div>
<p>Recall that <span class="math inline">\(p\)</span> is the number of variables (i.e., columns) in <span class="math inline">\(\mathbf{Y_c}\)</span></p>
</div><ol class="aside-footnotes"><li id="fn7"><p>対角行列</p></li></ol></aside></section>
<section id="singular-value-decomposition" class="slide level2">
<h2>Singular value decomposition</h2>
<p>Instead of solving <span class="math inline">\(\frac{\mathbf{Y_c}^\top \mathbf{Y_c}}{n-1} = \mathbf{\Sigma} = \mathbf{V}_{pca}\mathbf{L}\mathbf{V}_{pca}^\top\)</span> (i.e., eigenanalysis<sup>1</sup>), it is easier to do a singular value decomposition (SVD)<sup>2</sup>.</p>
<p><span class="math display">\[
\mathbf{Y_c} = \mathbf{U}\mathbf{D}\mathbf{V}_{svd}^\top
\]</span></p>
<aside><ol class="aside-footnotes"><li id="fn8"><p>固有値解析</p></li><li id="fn9"><p>特異値分解</p></li></ol></aside></section>
<section id="svd" class="slide level2">
<h2>SVD</h2>
<p><span class="math display">\[
\mathbf{Y_c} = \mathbf{U}\mathbf{D}\mathbf{V}_{svd}^\top
\]</span></p>
<p><span class="math inline">\(\mathbf{U}\)</span> is the left singular vectors<sup>1</sup> of <span class="math inline">\(\mathbf{Y_c}\)</span> and are the eigenvectors of <span class="math inline">\(\mathbf{Y_c}\mathbf{Y_c}^\top\)</span>.</p>
<aside><ol class="aside-footnotes"><li id="fn10"><p>左特異値ベクトル</p></li></ol></aside></section>
<section id="svd-1" class="slide level2">
<h2>SVD</h2>
<p><span class="math display">\[
\mathbf{Y_c} = \mathbf{U}\mathbf{D}\mathbf{V}_{svd}^\top
\]</span></p>
<p><span class="math inline">\(\mathbf{D}\)</span> is a diagonal matrix of the singular values<sup>1</sup>.</p>
<aside><ol class="aside-footnotes"><li id="fn11"><p>特異値</p></li></ol></aside></section>
<section id="svd-2" class="slide level2">
<h2>SVD</h2>
<p><span class="math display">\[
\mathbf{Y_c} = \mathbf{U}\mathbf{D}\mathbf{V}_{svd}^\top
\]</span></p>
<p><span class="math inline">\(\mathbf{V}_{svd}\)</span> is the right singular vectors<sup>1</sup> of <span class="math inline">\(\mathbf{Y_c}\)</span> and are the eigenvectors of <span class="math inline">\(\mathbf{Y_c}^\top\mathbf{Y_c}\)</span>.</p>

<aside><div>
<p>Note that <span class="math inline">\(\mathbf{V}_{pca} \approx \mathbf{V}_{sda}\)</span>.</p>
</div><ol class="aside-footnotes"><li id="fn12"><p>右特異値ベクトル</p></li></ol></aside></section>
<section id="solving-for-mathbfl" class="slide level2">
<h2>Solving for <span class="math inline">\(\mathbf{L}\)</span></h2>
<p>To find the eigenvalue, we must solve for <span class="math inline">\(\mathbf{\Sigma}\)</span>.</p>
<p><span class="math display">\[
\mathbf{\Sigma} = \frac{\mathbf{Y_c}^\top \mathbf{Y_c}}{n-1 }
\]</span></p>
<p><span class="math display">\[
\mathbf{Y_c} = \mathbf{U}\mathbf{D}\mathbf{V}_{svd}^\top
\]</span></p>
</section>
<section id="substitute-mathbfy_c-in-to-mathbfsigma" class="slide level2">
<h2>Substitute <span class="math inline">\(\mathbf{Y_c}\)</span> in to <span class="math inline">\(\mathbf{\Sigma}\)</span></h2>
<p><span class="math display">\[
\begin{aligned}
\mathbf{\Sigma} &amp;= \frac{\mathbf{Y_c}^\top \mathbf{Y_c}}{n-1 }\\
&amp; \mathbf{Y_c} = \mathbf{U}\mathbf{D}\mathbf{V}_{svd}^\top \\
\mathbf{\Sigma} &amp;= \frac{(\mathbf{U}\mathbf{D}\mathbf{V}_{svd}^\top )^\top (\mathbf{D}\mathbf{S}\mathbf{V}_{svd}^\top )}{n-1 } \\
\mathbf{\Sigma} &amp;= \frac{\mathbf{V}_{svd}\mathbf{D}^\top\mathbf{U}^\top \mathbf{U} \mathbf{D} \mathbf{V}_{svd}^\top}{n-1 }\\
\end{aligned}
\]</span></p>
</section>
<section id="substitute-mathbfy_c-in-to-mathbfsigma-1" class="slide level2 smaller">
<h2>Substitute <span class="math inline">\(\mathbf{Y_c}\)</span> in to <span class="math inline">\(\mathbf{\Sigma}\)</span></h2>
<p>Since <span class="math inline">\(\mathbf{U}^\top\mathbf{U}=1\)</span>,</p>
<p><span class="math display">\[
\mathbf{\Sigma} =
\frac{\mathbf{V}_{svd}\mathbf{D}^\top \mathbf{D} \mathbf{V}_{svd}^\top}{n-1 } =
\mathbf{V}_{pca}\mathbf{L}\mathbf{V}_{pca}^\top
\]</span></p>
<p>and <span class="math inline">\(\mathbf{V}^\top\mathbf{V}=1\)</span>,</p>
<p><span class="math display">\[
\mathbf{\Sigma} =
\frac{\mathbf{D}^\top\mathbf{D}}{n-1} = \mathbf{L}
\]</span></p>
<p>or more simply, <span class="math inline">\(\lambda_i = \frac{d_i^2}{n-1}\)</span>.</p>
</section>
<section id="visualize-what-we-want-to-do" class="slide level2 smaller">
<h2>Visualize what we want to do</h2>

<img data-src="pca_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>The rotation angle <span class="math inline">\(\theta\)</span> can also be determined from the rotation vector as follows: <span class="math inline">\(\mathbf{V}_\text{svd} = \begin{bmatrix} \cos\theta &amp; -\sin\theta\\ \sin\theta &amp; \cos\theta\\ \end{bmatrix}\)</span>.</p>
</section>
<section id="computation-mechanics" class="slide level2">
<h2>Computation mechanics</h2>
<div style="font-size:50%;">
<p>Apply SVD to the previous example results in the following equation.</p>
<p><span class="math display">\[
\overbrace{\begin{bmatrix}2.25 &amp; 2.00 &amp; 2.00\\-1.75 &amp;  0.00 &amp; -2.00\\ 0.25 &amp; -1.00 &amp; -2.00\\-0.75 &amp; -1.00 &amp;  2.00\end{bmatrix}}^{\mathbf{Y_c}} =
\overbrace{\begin{bmatrix}-0.73 &amp;  0.43 &amp; -0.15\\ 0.526 &amp;  0.078 &amp; -0.683\\0.39 &amp; 0.33 &amp; 0.70\\-0.18 &amp; -0.84 &amp;  0.13\end{bmatrix} }^{\mathbf{U}}\times
\overbrace{\begin{bmatrix}4.66 &amp; 0.00 &amp; 0.00\\0.00 &amp; 2.63 &amp; 0.00\\0.00 &amp; 0.00 &amp; 1.47\end{bmatrix} }^{\mathbf{D}}\times
\overbrace{\begin{bmatrix}-0.50 &amp; -0.36 &amp; -0.79\\ 0.59 &amp;  0.52 &amp; -0.62\\ 0.633 &amp; -0.772 &amp; -0.051\end{bmatrix} }^{\mathbf{V}^\top}
\]</span></p>
</div>

<img data-src="pca_files/figure-revealjs/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center r-stretch" width="500"></section>
<section id="example-1-determine-mathbfy_c" class="slide level2">
<h2>Example 1: determine <span class="math inline">\(\mathbf{Y_c}\)</span></h2>
<p>Calculate the centered data matrix.</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-8_cd1bc92d990cc127e01382ea24e99564">
<div class="column">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>Y <span class="ot">=</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb1-2"><a></a><span class="fu">colnames</span>(Y) <span class="ot">=</span> <span class="fu">colnames</span>(iris)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">|&gt;</span> </span>
<span id="cb1-3"><a></a>  <span class="fu">str_remove_all</span>(<span class="st">"[a-z|</span><span class="sc">\\</span><span class="st">.]+"</span>) </span>
<span id="cb1-4"><a></a>nm <span class="ot">=</span> <span class="fu">dim</span>(Y)</span>
<span id="cb1-5"><a></a>Ybar <span class="ot">=</span> <span class="fu">apply</span>(Y, <span class="dv">2</span>, mean)</span>
<span id="cb1-6"><a></a>Ybar <span class="ot">=</span> <span class="fu">matrix</span>(Ybar, <span class="at">ncol =</span> nm[<span class="dv">2</span>], </span>
<span id="cb1-7"><a></a>              <span class="at">nrow =</span> nm[<span class="dv">1</span>],</span>
<span id="cb1-8"><a></a>              <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-9"><a></a>Yc <span class="ot">=</span> Y <span class="sc">-</span> Ybar</span>
<span id="cb1-10"><a></a>Yc <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>      SL     SW
1  0.094  0.072
2 -0.106 -0.428
3 -0.306 -0.228
4 -0.406 -0.328
5 -0.006  0.172
6  0.394  0.472</code></pre>
</div>
</div>
</div>
</section>
<section id="example-1-svd" class="slide level2">
<h2>Example 1: SVD</h2>
<p>Calculate the eigenvectors, eigenvalues, and singular values using <code>svd()</code>.</p>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-9_97af5db8acef1ae25f9694b2ef5e9dba">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>svdout <span class="ot">=</span> <span class="fu">svd</span>(Yc)</span>
<span id="cb3-2"><a></a>umat <span class="ot">=</span> svdout<span class="sc">$</span>u  <span class="co"># Left singular vectors</span></span>
<span id="cb3-3"><a></a>vmat <span class="ot">=</span> svdout<span class="sc">$</span>v  <span class="co"># Right singular vectors (i.e., eigenvectors)</span></span>
<span id="cb3-4"><a></a>d <span class="ot">=</span> svdout<span class="sc">$</span>d     <span class="co"># Singular values</span></span>
<span id="cb3-5"><a></a>n <span class="ot">=</span> nm[<span class="dv">1</span>]        <span class="co"># Data rows</span></span>
<span id="cb3-6"><a></a>p <span class="ot">=</span> nm[<span class="dv">2</span>]        <span class="co"># Data columns (i.e., variables)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-1-eigenvalues" class="slide level2">
<h2>Example 1: eigenvalues</h2>
<p>Recall that,</p>
<p><span class="math display">\[
\lambda_i = \frac{d_i^2} {n-1}
\]</span></p>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-10_726a38d75bc1dfb9125c8611034718f0">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="co"># lambda = ((diag(d) %*% t(diag(d))) / (n - 1)) |&gt; diag()</span></span>
<span id="cb4-2"><a></a>lambda <span class="ot">=</span> d<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Therefore, the eigenvalues are 0.2337 and 0.0343.</p>
</section>
<section id="example-1-eigenvectors" class="slide level2">
<h2>Example 1: eigenvectors</h2>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-11_e385ec5a76943ca14653e6596d54f660">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="fu">rownames</span>(vmat) <span class="ot">=</span> <span class="fu">colnames</span>(Yc)</span>
<span id="cb5-2"><a></a><span class="fu">colnames</span>(vmat) <span class="ot">=</span> <span class="fu">str_glue</span>(<span class="st">"PC{1:p}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The eigenvectors are:</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-12_3c3d42357f0295b0d35b3bd55dc77660">
<div class="column">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>vmat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>          PC1        PC2
SL -0.6717496 -0.7407783
SW -0.7407783  0.6717496</code></pre>
</div>
</div>
</div>
</section>
<section id="example-1-mechanics-of-rotating-mathbfy_c" class="slide level2">
<h2>Example 1: mechanics of rotating <span class="math inline">\(\mathbf{Y_c}\)</span></h2>
<div class="cell" data-layout-align="center" data-hash="pca_cache/revealjs/unnamed-chunk-13_94d6fff5a62965d7ca42af196adf2fc7">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pca_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>The eigenvectors indicate the direction of the vectors that maximizes the variance of each axis. In this case, maximizing the variance in one axis lead to a minimization in the other.</p>
</div></aside></section>
<section id="example-1-derived-information" class="slide level2 smaller">
<h2>Example 1: derived information</h2>
<p>The total variance before rotation is:</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-14_df79ce9f1c4205f8847ce881376d6ded">
<div class="column">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="fu">diag</span>(<span class="fu">var</span>(Yc)) <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2679388</code></pre>
</div>
</div>
</div>
<p>and should be the same as the total inertia (i.e., variance) after rotation:</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-15_5d58629a7a0998239fce31c92ac9310b">
<div class="column">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="fu">sum</span>(lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2679388</code></pre>
</div>
</div>
</div>
<p>The variance of <code>SL</code> and <code>SW</code> is:</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-16_6e40e465011d0f565cbf6d1b2a6c1d67">
<div class="column">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="fu">diag</span>(<span class="fu">var</span>(Yc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>       SL        SW 
0.1242490 0.1436898 </code></pre>
</div>
</div>
</div>
</section>
<section id="example-1-more-derived-information" class="slide level2 smaller">
<h2>Example 1: more derived information</h2>
<p>The relative importance of <code>SL</code> and <code>SW</code> is:</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-17_83d88b4f088dc6a961d1cdf1b83b377f">
<div class="column">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="fu">diag</span>(<span class="fu">var</span>(Yc)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">diag</span>(<span class="fu">var</span>(Yc)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>       SL        SW 
0.4637215 0.5362785 </code></pre>
</div>
</div>
</div>
<p>However, the variance of the principal components and their relative importance is different:</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-18_8932c31d9fb0b6e0d913e2aefdf1e1b7">
<div class="column">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>lambda <span class="co"># The variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.23366074 0.03427804</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>importance <span class="ot">=</span> lambda <span class="sc">/</span> <span class="fu">sum</span>(lambda)</span>
<span id="cb18-2"><a></a><span class="fu">names</span>(importance) <span class="ot">=</span> <span class="fu">colnames</span>(vmat)</span>
<span id="cb18-3"><a></a>importance <span class="co"># The relative importance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PC1       PC2 
0.8720677 0.1279323 </code></pre>
</div>
</div>
</div>

<aside><div>
<p>The relative importance indicates the proportion of variation explained by the principal component axis. Conceptually, <span class="math inline">\(\mathbf{Y_c}\)</span> is rotated until each component is maximized successively.</p>
</div></aside></section>
<section id="example-1-scores-and-loadings" class="slide level2">
<h2>Example 1: scores and loadings</h2>
<p><strong>Scores</strong><sup>1</sup> are the data points projected onto the principal component axes.</p>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-19_2b645b0366e4a26a1df434fe12a15c6f">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a><span class="co"># There are a total of n = 50 scores.</span></span>
<span id="cb20-2"><a></a>scores <span class="ot">=</span> umat <span class="sc">%*%</span> <span class="fu">diag</span>(d)</span>
<span id="cb20-3"><a></a><span class="fu">colnames</span>(scores) <span class="ot">=</span> <span class="fu">str_c</span>(<span class="st">"PC"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(scores))</span>
<span id="cb20-4"><a></a>scores <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PC1         PC2
[1,] -0.1164805 -0.02126719
[2,]  0.3882586 -0.20898631
[3,]  0.3744528  0.07351926
[4,]  0.5157056  0.08042214
[5,] -0.1233834  0.11998560
[6,] -0.6143167  0.02519914</code></pre>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn13"><p>主成分得点: あるデータ点を主成分ベクトルで表現した場合の値</p></li></ol></aside></section>
<section id="example-1-scores-and-loadings-1" class="slide level2 smaller">
<h2>Example 1: scores and loadings</h2>
<p><strong>Loadings</strong> (rescaled loadings)<sup>1</sup> indicates the relationship of the variable with the principal component axes.</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-20_168f33c243aee6d524a0bf877e78548b">
<div class="column">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>loadings <span class="ot">=</span> (vmat <span class="sc">%*%</span> <span class="fu">diag</span>(d)) <span class="sc">/</span> <span class="fu">sqrt</span>(n<span class="dv">-1</span>)</span>
<span id="cb22-2"><a></a><span class="fu">colnames</span>(loadings) <span class="ot">=</span> <span class="fu">str_glue</span>(<span class="st">"PC{1:p}"</span>)</span>
<span id="cb22-3"><a></a>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>          PC1        PC2
SL -0.3247134 -0.1371501
SW -0.3580809  0.1243699</code></pre>
</div>
</div>
</div>
<p>Therefore, for variable <code>SL</code>, the loadings on <code>PC1</code> and <code>PC2</code> are -0.325 and -0.137, respectively. The cosine of the angle between loadings are their correlation.</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-21_4dc3656dbb4e6da9ce4ebf7e94a57296">
<div class="column">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>SL <span class="ot">=</span> loadings[<span class="dv">1</span>, ]</span>
<span id="cb24-2"><a></a>SW <span class="ot">=</span> loadings[<span class="dv">2</span>, ]</span>
<span id="cb24-3"><a></a>L1 <span class="ot">=</span> <span class="fu">atan2</span>(<span class="at">y =</span> SL[<span class="dv">2</span>], <span class="at">x =</span> SL[<span class="dv">1</span>])</span>
<span id="cb24-4"><a></a>L2 <span class="ot">=</span> <span class="fu">atan2</span>(<span class="at">y =</span> SW[<span class="dv">2</span>], <span class="at">x =</span> SW[<span class="dv">1</span>])</span>
<span id="cb24-5"><a></a>theta <span class="ot">=</span> <span class="fu">abs</span>(L1 <span class="sc">-</span> L2)</span>
<span id="cb24-6"><a></a><span class="fu">cos</span>(theta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>      PC2 
0.7425467 </code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn14"><p>主成分負荷量: ある主成分ベクトルのデータ点に対する重み</p></li></ol></aside></section>
<section id="example-2-veganrda" class="slide level2 smaller">
<h2>Example 2: <code>vegan::rda()</code></h2>
<p>First run the analysis with both <code>rda()</code> and `svd().</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-22_8a1c55b4413008a84478485f08ffb5e5">
<div class="column">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>rdaout <span class="ot">=</span> <span class="fu">rda</span>(Yc)</span>
<span id="cb26-2"><a></a>svdout <span class="ot">=</span> <span class="fu">svd</span>(Yc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div>
</div>
<p><strong>Left singular matrix</strong><sup>1</sup></p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-23_da580f8306eb9855aae416449adac84a">
<div class="column">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>svdout<span class="sc">$</span>u <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">2</span>)     <span class="co"># SDV result</span></span>
<span id="cb27-2"><a></a>rdaout<span class="sc">$</span>CA<span class="sc">$</span>u <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">2</span>)  <span class="co"># RDA result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]        [,2]
[1,] -0.03442408 -0.01640983
[2,]  0.11474404 -0.16125450
          PC1         PC2
1 -0.03442408 -0.01640983
2  0.11474404 -0.16125450</code></pre>
</div>
</div>
</div>
<p><strong>Right singular matrix</strong><sup>2</sup></p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-24_b287fa1a070a5674762ea27c11d2e889">
<div class="column">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>svdout<span class="sc">$</span>v <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">2</span>)    <span class="co"># SDV result</span></span>
<span id="cb29-2"><a></a>rdaout<span class="sc">$</span>CA<span class="sc">$</span>v <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="co"># RDA result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]
[1,] -0.6717496 -0.7407783
[2,] -0.7407783  0.6717496
          PC1        PC2
SL -0.6717496 -0.7407783
SW -0.7407783  0.6717496</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn15"><p>左特異値ベクトル</p></li><li id="fn16"><p>右特異値ベクトル</p></li></ol></aside></section>
<section id="example-2-veganrda-1" class="slide level2">
<h2>Example 2: <code>vegan::rda()</code></h2>
<p><strong>Eigenvalues</strong></p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-25_bcba784b455c019cc31242ac3a1ea37c">
<div class="column">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a>(svdout<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(n<span class="dv">-1</span>) <span class="co"># SDV result</span></span>
<span id="cb31-2"><a></a>rdaout<span class="sc">$</span>CA<span class="sc">$</span>eig      <span class="co"># RDA result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.23366074 0.03427804
       PC1        PC2 
0.23366074 0.03427804 </code></pre>
</div>
</div>
</div>
</section>
<section id="example-2-similar-output" class="slide level2 smaller">
<h2>Example 2: similar output</h2>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-26_7fa3352bef893fa20ccb40a8e86d4e18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>rdaout <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">display =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(X = Yc) 

Partitioning of variance:
              Inertia Proportion
Total          0.2679          1
Unconstrained  0.2679          1

Eigenvalues, and their contribution to the variance 

Importance of components:
                         PC1     PC2
Eigenvalue            0.2337 0.03428
Proportion Explained  0.8721 0.12793
Cumulative Proportion 0.8721 1.00000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  </code></pre>
</div>
</div>
<div class="absolute" style="top: 200px; left: 500px; width: 500px; height: 500px; ">
<ul>
<li>Note the total inertia is the sum of the eigenvalues 0.268.</li>
<li>The proportion explained is the ratio of the eigenvalues to the sum of the eigenvalues <span class="math inline">\((\lambda_i / \sum{\lambda_i})\)</span>.</li>
</ul>
</div>

<aside><div>
<p>At this stage numeric results from <code>svd()</code> and <code>rda()</code> are equivalent. However, the scores and loadings are scaled differently.</p>
</div></aside></section>
<section id="example-2-vegan-like-analysis" class="slide level2 smaller">
<h2>Example 2: <code>vegan</code>-like analysis</h2>
<p>In <code>vegan::rda()</code>, the <strong>scores</strong> are scaled according to the following:</p>
<ul>
<li><strong>scaling = 1:</strong><sup>1</sup> <span class="math inline">\(C\sqrt{\lambda_i / \sum\lambda_i}\)</span></li>
<li><strong>scaling = 2:</strong><sup>2</sup> <span class="math inline">\(C\)</span></li>
</ul>
<p>The constant term is <span class="math inline">\(C = \sqrt[4]{(n -1)\sum{\lambda_i}}\)</span>.</p>
<p>See the decision-vegan.pdf vignette for details.</p>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-27_d6ee87fc5cd9b5ccacfd644c46ab0353">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a>const <span class="ot">=</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sum</span>(lambda))<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>}</span>
<span id="cb35-2"><a></a>scale1 <span class="ot">=</span> <span class="fu">sqrt</span>(lambda <span class="sc">/</span> <span class="fu">sum</span>(lambda) ) <span class="sc">*</span> const</span>
<span id="cb35-3"><a></a>scale2 <span class="ot">=</span> const</span>
<span id="cb35-4"><a></a>umat1 <span class="ot">=</span> umat <span class="sc">%*%</span> <span class="fu">diag</span>(scale1)</span>
<span id="cb35-5"><a></a>umat2 <span class="ot">=</span> umat <span class="sc">*</span> scale2</span>
<span id="cb35-6"><a></a>vmat1 <span class="ot">=</span> vmat <span class="sc">%*%</span> <span class="fu">diag</span>(scale1)</span>
<span id="cb35-7"><a></a>vmat2 <span class="ot">=</span> vmat <span class="sc">*</span> scale2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside><ol class="aside-footnotes"><li id="fn17"><p>Interpret spatial patterns.</p></li><li id="fn18"><p>Interpret vector directions and angles.</p></li></ol></aside></section>
<section id="example-2-scaling-1-and-2" class="slide level2 smaller">
<h2>Example 2: scaling = 1 and 2</h2>
<p><strong>Scaling 1</strong></p>
<p><span class="math display">\[
\mathbf{U}_1 =
\mathbf{U} \times
\begin{bmatrix}
\frac{\sqrt{\lambda_1}}{\sum\lambda_k} &amp; 0 &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; \frac{\sqrt{\lambda_2}}{\sum\lambda_k} &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; 0 &amp; \ddots &amp; \cdots &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \cdots  &amp; \frac{\sqrt{\lambda_k}}{\sum\lambda_k} \\
\end{bmatrix} \times
\sqrt[4]{(n -1)\sum{\lambda_k}}
\]</span></p>
<p><strong>Scaling 2</strong></p>
<p><span class="math display">\[
\mathbf{U}_2 = \mathbf{U} \times
\sqrt[4]{(n -1)\sum{\lambda_k}}
\]</span></p>
<p><span class="math inline">\(\mathbf{U}_1\)</span> and <span class="math inline">\(\mathbf{U}_2\)</span> are the scaled scores.</p>
</section>
<section id="example-2-no-scaling" class="slide level2 smaller">
<h2>Example 2: no scaling</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-28_1334c13b3ec54d379c0b3a3e36f22d4d">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="pca_files/figure-revealjs/unnamed-chunk-28-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<p>The unscaled principal components are in the matrix <span class="math inline">\(\mathbf{U}\)</span>. The black circles indicate the <code>vegan::rda()</code> output and the colored dots indicate the results based on the SVD.</p>
</div>
</div>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-29_b0d5c1b09a23483643727615ed93e75b">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a>limits <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb36-2"><a></a>tmp <span class="ot">=</span> <span class="fu">scores</span>(rdaout, <span class="at">scaling =</span> <span class="st">"none"</span>, <span class="at">display =</span> <span class="st">"species"</span>)</span>
<span id="cb36-3"><a></a>tmp <span class="ot">=</span> tmp <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(<span class="fu">sqrt</span>(tmp <span class="sc">%*%</span> <span class="fu">t</span>(tmp)))) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb36-4"><a></a><span class="fu">scores</span>(rdaout, <span class="at">scaling =</span> <span class="st">"none"</span>, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-5"><a></a>  <span class="fu">plot</span>(<span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlim =</span> limits, <span class="at">ylim =</span> limits)</span>
<span id="cb36-6"><a></a><span class="fu">points</span>(umat[,<span class="dv">1</span>], umat[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb36-7"><a></a><span class="fu">segments</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>])</span>
<span id="cb36-8"><a></a><span class="fu">text</span>(tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>], <span class="at">labels =</span> <span class="fu">rownames</span>(tmp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-2-scaling-1" class="slide level2 smaller">
<h2>Example 2: scaling 1</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-30_dfbc59c6250d9000d4dae15a47905d88">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="pca_files/figure-revealjs/unnamed-chunk-30-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<p>The scaled principal components are in the matrix <span class="math inline">\(\mathbf{U}_1\)</span>. The black circles indicate the <code>vegan::rda()</code> output and the colored dots indicate the results based on the SVD. Distances between dots indicate approximate euclidean distances <span class="math inline">\((d = \sqrt{x^2+y^2})\)</span><sup>1</sup>.</p>
</div>
</div>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-31_a0e6bf0cd8bf8ee3a5c91fc6f9c65d68">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>limits <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb37-2"><a></a>tmp <span class="ot">=</span> <span class="fu">scores</span>(rdaout, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">display =</span> <span class="st">"species"</span>)</span>
<span id="cb37-3"><a></a>tmp <span class="ot">=</span> tmp <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(<span class="fu">sqrt</span>(tmp <span class="sc">%*%</span> <span class="fu">t</span>(tmp))))</span>
<span id="cb37-4"><a></a><span class="fu">scores</span>(rdaout, <span class="at">scaling =</span> <span class="dv">1</span>, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-5"><a></a>  <span class="fu">plot</span>(<span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlim =</span> limits, <span class="at">ylim =</span> limits)</span>
<span id="cb37-6"><a></a><span class="fu">points</span>(umat1[,<span class="dv">1</span>], umat1[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb37-7"><a></a><span class="fu">segments</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>])</span>
<span id="cb37-8"><a></a><span class="fu">text</span>(tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>], <span class="at">labels =</span> <span class="fu">rownames</span>(tmp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside><ol class="aside-footnotes"><li id="fn19"><p>ユークリッド距離</p></li></ol></aside></section>
<section id="example-2-scaling-2" class="slide level2 smaller">
<h2>Example 2: scaling 2</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-32_f1a173d23a422dce2986f164090e504b">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="pca_files/figure-revealjs/unnamed-chunk-32-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<p>The scaled principal components are in the matrix <span class="math inline">\(\mathbf{U}_2\)</span>. The black circles indicate the <code>vegan::rda()</code> output and the colored dots indicate the results based on the SVD. Angles between vectors (radians) indicate correlation.</p>
</div>
</div>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-33_10855b1769e5d1a0147b1877b5e68e79">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a>limits <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb38-2"><a></a>tmp <span class="ot">=</span> <span class="fu">scores</span>(rdaout, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">scaling =</span> <span class="dv">2</span>, <span class="at">display =</span> <span class="st">"species"</span>)</span>
<span id="cb38-3"><a></a>tmp <span class="ot">=</span> tmp <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(<span class="fu">sqrt</span>(tmp <span class="sc">%*%</span> <span class="fu">t</span>(tmp)))) </span>
<span id="cb38-4"><a></a><span class="fu">scores</span>(rdaout, <span class="at">scaling =</span> <span class="dv">2</span>, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a></a>  <span class="fu">plot</span>(<span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlim =</span> limits, <span class="at">ylim =</span> limits)</span>
<span id="cb38-6"><a></a><span class="fu">points</span>(umat2[,<span class="dv">1</span>], umat2[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb38-7"><a></a><span class="fu">segments</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>])</span>
<span id="cb38-8"><a></a><span class="fu">text</span>(tmp[,<span class="dv">1</span>], tmp[,<span class="dv">2</span>], <span class="at">labels =</span> <span class="fu">rownames</span>(tmp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-3-unscaled-3d-plot" class="slide level2">
<h2>Example 3: unscaled 3D plot</h2>

<img data-src="pca_files/figure-revealjs/unnamed-chunk-35-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="example-3-scaled-3d-plot" class="slide level2">
<h2>Example 3: scaled 3D plot</h2>
<div class="cell quarto-layout-panel" data-hash="pca_cache/revealjs/unnamed-chunk-36_15abe5c41ac676963093649f001a4ecd" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pca_files/figure-revealjs/unnamed-chunk-36-1.png" style="width:100.0%"></p>
<figcaption>Scaling = 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pca_files/figure-revealjs/unnamed-chunk-36-2.png" style="width:100.0%"></p>
<figcaption>Scaling = 2</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="example-3-summary-output" class="slide level2 smaller">
<h2>Example 3: summary output</h2>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-37_f9563ba018577937c481c78ddb3e89c8">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a>rdaout <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">display =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(X = Yc) 

Partitioning of variance:
              Inertia Proportion
Total           3.992          1
Unconstrained   3.992          1

Eigenvalues, and their contribution to the variance 

Importance of components:
                         PC1     PC2     PC3
Eigenvalue            3.6911 0.24138 0.05945
Proportion Explained  0.9246 0.06047 0.01489
Cumulative Proportion 0.9246 0.98511 1.00000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  </code></pre>
</div>
</div>
<p><code>PC1</code> explains 92.46 % of the inertia, therefore most of the variation occurs along the <code>PC1</code> axis.</p>
</section>
<section id="example-4-correlations-among-vectors" class="slide level2">
<h2>Example 4: correlations among vectors</h2>
<p>The correlation between two vectors is determined as</p>
<p><span class="math display">\[
\begin{aligned}
\cos\theta &amp;= \frac{v_1\cdot v_2}{\lVert v_1 \rVert \lVert v_2 \rVert} \\
\sin\theta &amp;= \frac{\lVert v_1\times v_2 \rVert}{\lVert v_1 \rVert \lVert v_2 \rVert} \\
\tan\theta &amp;= \frac{\lVert v_1\times v_2\rVert}{v_1 \cdot v_2 } \\
\end{aligned}
\]</span></p>
</section>
<section id="example-3-problem" class="slide level2">
<h2>Example 3: problem</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>The correlation between two vectors is the cosine of the angle between the vectors.</p>
<p><span class="math display">\[
\cos\theta = \frac{v_1\cdot v_2}{\lVert v_1 \rVert \lVert v_2 \rVert}
\]</span></p>
</div><div class="column" style="width:60%;">
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-39_202b40c1b7914504d46556f68e8e220e">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pca_files/figure-revealjs/unnamed-chunk-39-1.png" style="width:100.0%"></p>
<figcaption>Determine the angle of the shaded region.</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-3-partial-solution" class="slide level2 smaller">
<h2>Example 3: partial solution</h2>
<p><span class="math display">\[
\cos\theta = \frac{v_1\cdot v_2}{\lVert v_1 \rVert \lVert v_2 \rVert}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
v_1 &amp;= \begin{bmatrix}  1.85 &amp; -0.78 &amp; -0.40 \end{bmatrix} \\
v_2 &amp;= \begin{bmatrix} -0.43 &amp; -0.90 &amp;  0.40 \end{bmatrix} \\
\lVert v_1\rVert &amp;= \sqrt{\begin{bmatrix}  1.85 &amp; -0.78 &amp; -0.40 \end{bmatrix} \begin{bmatrix}  1.85 \\ -0.78 \\ -0.40 \end{bmatrix}}  = 2.05 \\
\lVert v_2\rVert &amp;= \sqrt{\begin{bmatrix} -0.43 &amp; -0.90 &amp;  0.40 \end{bmatrix} \begin{bmatrix} -0.43 \\ -0.90 \\  0.40 \end{bmatrix}}  = 1.08 \\
\end{aligned}
\]</span></p>
</section>
<section id="example-3-final-solution" class="slide level2 smaller">
<h2>Example 3: final solution</h2>
<p><span class="math display">\[
\cos\theta = \frac{\begin{bmatrix}  1.85 &amp; -0.78 &amp; -0.40 \end{bmatrix} \begin{bmatrix} -0.43 \\ -0.90 \\  0.40 \end{bmatrix}}{2.05 \times 1.08}
\]</span></p>
<p><span class="math display">\[
\cos\theta = \frac{-0.26}{2.05 \times1.08} = -0.12
\]</span> The correlation between the two vectors is -0.12. The angle between the two vectors is <span class="math inline">\(\cos^{-1}(\text{-0.1176}) =\)</span> 1.6886 radians, or 96.7519<span class="math inline">\({}^\circ\)</span>.</p>
</section>
<section id="example-3-correlations-in-r" class="slide level2 smaller">
<h2>Example 3: correlations in R</h2>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-40_2298df3a606577c9e27554144fb505e3">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a>calc_costheta <span class="ot">=</span> <span class="cf">function</span>(v1, v2) {</span>
<span id="cb41-2"><a></a>  v1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(v1), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb41-3"><a></a>  v2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">as.numeric</span>(v2), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb41-4"><a></a>  bot <span class="ot">=</span> <span class="fu">sqrt</span>(v1 <span class="sc">%*%</span> <span class="fu">t</span>(v1)) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">t</span>(v2)  <span class="sc">%*%</span> v2)</span>
<span id="cb41-5"><a></a>  top <span class="ot">=</span> v1 <span class="sc">%*%</span> v2</span>
<span id="cb41-6"><a></a>  costheta <span class="ot">=</span> (top<span class="sc">/</span>bot)</span>
<span id="cb41-7"><a></a>  costheta</span>
<span id="cb41-8"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Isolate the vectors.</p>
<div class="cell" data-hash="pca_cache/revealjs/unnamed-chunk-41_781110228b59bb7332ff1e827947b1d7">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a>sl <span class="ot">=</span> vmat[<span class="st">"SL"</span>, ]</span>
<span id="cb42-2"><a></a>sw <span class="ot">=</span> vmat[<span class="st">"SW"</span>, ]</span>
<span id="cb42-3"><a></a>pl <span class="ot">=</span> vmat[<span class="st">"PL"</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate <span class="math inline">\(\cos\theta\)</span>.</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-42_245cdb6415c73be3748a6491cc86ccf0">
<div class="column">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="fu">calc_costheta</span>(sl, sw)</span>
<span id="cb43-2"><a></a><span class="fu">calc_costheta</span>(sl, pl)</span>
<span id="cb43-3"><a></a><span class="fu">calc_costheta</span>(pl, sw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] -0.1175698
          [,1]
[1,] 0.8717538
           [,1]
[1,] -0.4284401</code></pre>
</div>
</div>
</div>
<p>It is easier to calculate the correlations on the original centered data.</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-43_0225d66124701cbdf15dd96fe1744891">
<div class="column">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a><span class="fu">cor</span>(Yc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>           SL         SW         PL
SL  1.0000000 -0.1175698  0.8717538
SW -0.1175698  1.0000000 -0.4284401
PL  0.8717538 -0.4284401  1.0000000</code></pre>
</div>
</div>
</div>
</section>
<section id="example-3-variable-pc-correlations" class="slide level2 smaller">
<h2>Example 3: variable – PC correlations</h2>
<p>To determine the correlations of each variable with respect to the principal component axes, use the function.</p>
<div class="cell columns column-output-location" data-hash="pca_cache/revealjs/unnamed-chunk-44_c180bbe30d9322ca376cab9fd08c65f2">
<div class="column">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a>I <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb47-2"><a></a>cc <span class="ot">=</span> \(x) {<span class="fu">calc_costheta</span>(sl, I[x, ])}</span>
<span id="cb47-3"><a></a>pcsl <span class="ot">=</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, cc)</span>
<span id="cb47-4"><a></a>pcsw <span class="ot">=</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, cc)</span>
<span id="cb47-5"><a></a>pcpl <span class="ot">=</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, cc)</span>
<span id="cb47-6"><a></a><span class="fu">matrix</span>(<span class="fu">c</span>(pcsl, pcsw, pcpl), <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb47-7"><a></a>       <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">str_glue</span>(<span class="st">"PC{1:3}"</span>), </span>
<span id="cb47-8"><a></a>                       <span class="fu">c</span>(<span class="st">"SL"</span>, <span class="st">"SW"</span>, <span class="st">"PL"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>            SL         SW         PL
PC1  0.9044678  0.9044678  0.9044678
PC2 -0.3792589 -0.3792589 -0.3792589
PC3 -0.1951939 -0.1951939 -0.1951939</code></pre>
</div>
</div>
</div>
<p>The <code>SL</code> and <code>PL</code> vectors are positively correlated with <code>PC1</code> (0.9045 and 0.9045, respectively). Whereas the <code>SW</code> vector is negatively correlated with <code>PC2</code> (-0.3793).</p>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<p>https://qiita.com/horiem/items/71380db4b659fb9307b4</p>
<p>https://stats.stackexchange.com/questions/141085/positioning-the-arrows-on-a-pca-biplot</p>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-hotelling1933" class="csl-entry" role="listitem">
Hotelling, H. 1933. <span>“Analysis of a Complex of Statistical Variables into Principal Components.”</span> <em>Journal of Educational Psychology</em> 24 (6): 417–41. <a href="https://doi.org/10.1037/h0071325">https://doi.org/10.1037/h0071325</a>.
</div>
<div id="ref-jolliffe2016" class="csl-entry" role="listitem">
Jolliffe, Ian T., and Jorge Cadima. 2016. <span>“Principal Component Analysis: A Review and Recent Developments.”</span> <em>Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences</em> 374 (2065): 20150202. <a href="https://doi.org/10.1098/rsta.2015.0202">https://doi.org/10.1098/rsta.2015.0202</a>.
</div>
<div id="ref-pearson1901" class="csl-entry" role="listitem">
Pearson, Karl. 1901. <span>“LIII. <span><em>On Lines and Planes of Closest Fit to Systems of Points in Space</em></span>.”</span> <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em> 2 (11): 559–72. <a href="https://doi.org/10.1080/14786440109462720">https://doi.org/10.1080/14786440109462720</a>.
</div>
</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>